<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IronGram</title>
</head>
<body>
<form action="login" method="post" id="login" hidden>
    <input type="test" placeholder="username" name="username"/>
    <input type="password" placeholder="password" name="password"/>
    <button type="submit">Login</button>
</form>

<form action="logout" method="post" id="logout" hidden>
    Welcome, <span id="username"></span>
    <button type="submit">Logout</button>
</form>
<br><br>
<form action="/upload" method="post" id="upload" enctype="multipart/form-data" hidden>
    <input type="text" placeholder="Receiver name" name="receiver"/>
    <input type="file" name="photo"/>
    <input type="number" placeholder="interval" name="interval"/>
    <input type="checkbox" name="isPublic"/> Is this a public photo?
    <button type="submit">Upload</button>
</form>
<br>
<a href="/public-photos">View Public Photos</a>
<br>
<div id="photos"></div>

<script src="jquery-2.1.4.min.js"></script>
<script>
    function getPhotos(photosData){
        $("#photos").empty();
       for (var i  in photosData){
            var photo = photosData[i];
            var elem = $("<img>");
            elem.attr("src", photo.filename);
            $("#photos").append(elem);
            $("#photos").append(photo.date);
            $("#photos").append(photo.interval);
            $("#photos").append(photo.isPublic);
        }
    }

    function getPhotosAjax(){
        $.get("/photos", getPhotos);

    }

    function getUser(userData) {
        if (userData.length == 0){
            $("#login").show();
        }
        else {
            $("#logout").show();
            $("#upload").show();
            $("#username").text(userData.username);
            getPhotosAjax();
            setInterval(getPhotosAjax, 3000);
        }
    }

    $.get("/user", getUser);
</script>
</body>
</html>